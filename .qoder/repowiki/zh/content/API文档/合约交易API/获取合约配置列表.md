# 获取合约配置列表

<cite>
**本文档引用的文件**
- [contract.vue](file://agx-admin/src/views/agx/contract.vue)
- [index.js](file://agx-admin/src/api/agx/index.js)
- [admin.controller.ts](file://agx-backend/src/modules/admin/admin.controller.ts)
- [contract-config.entity.ts](file://agx-backend/src/entities/contract-config.entity.ts)
- [admin.service.ts](file://agx-backend/src/modules/admin/admin.service.ts)
- [api.js](file://h5/src/utils/api.js)
</cite>

## 目录
1. [接口概述](#接口概述)
2. [请求信息](#请求信息)
3. [响应结构](#响应结构)
4. [前端调用实现](#前端调用实现)
5. [使用场景](#使用场景)
6. [完整响应示例](#完整响应示例)

## 接口概述

`/api/contract/configs` 端点用于获取合约配置列表，该接口为公开接口，无需 JWT 认证即可访问。此接口主要用于前端初始化交易对配置列表，为用户提供合约交易的相关配置信息。

该接口在管理后台的 `contract.vue` 页面中用于展示和管理合约配置，同时也在 H5 移动端应用中用于获取合约配置信息以支持用户进行合约交易。

**Section sources**
- [contract.vue](file://agx-admin/src/views/agx/contract.vue#L188-L194)
- [api.js](file://h5/src/utils/api.js#L127-L128)

## 请求信息

### HTTP 方法
`GET`

### 端点
`/api/contract/configs`

### 请求参数
该接口为无参数请求，不需要传递任何查询参数或请求体。

### 认证要求
该接口为公开接口，**不需要 JWT 认证**，任何用户都可以访问。

### 请求示例
```http
GET /api/contract/configs HTTP/1.1
Host: example.com
Content-Type: application/json
```

**Section sources**
- [admin.controller.ts](file://agx-backend/src/modules/admin/admin.controller.ts#L137-L139)
- [api.js](file://h5/src/utils/api.js#L127)

## 响应结构

接口返回标准的 JSON 响应，包含一个包含合约配置列表的 `list` 数组。每个合约配置对象包含以下字段：

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 合约配置的唯一标识符 |
| symbol | string | 交易对符号，如 "BTCUSDT" |
| name | string | 合约名称，如 "BTC 30秒合约" |
| duration | number | 合约时长（秒） |
| profitRate | string | 收益率，以百分比表示的字符串 |
| minAmount | string | 最小交易金额 |
| maxAmount | string | 最大交易金额 |
| payCurrencies | string | 可用的支付币种，多个币种用逗号分隔 |
| status | number | 状态：1=启用，0=禁用 |
| createdAt | string | 创建时间，格式为 "YYYY-MM-DD HH:mm:ss" |

**Section sources**
- [contract-config.entity.ts](file://agx-backend/src/entities/contract-config.entity.ts#L2-L12)
- [admin.service.ts](file://agx-backend/src/modules/admin/admin.service.ts#L404-L415)

## 前端调用实现

前端通过 `agxApi.getContractList` 方法调用此接口。在管理后台中，该方法在 `contract.vue` 组件的 `fetchData` 函数中被调用，用于获取合约配置列表并显示在表格中。

```javascript
const fetchData = async () => {
  loading.value = true
  try {
    const res = await agxApi.getContractList({
      page: pagination.current,
      pageSize: pagination.pageSize,
      symbol: searchForm.symbol || undefined,
      status: searchForm.status
    })
    if (res.code === 0) {
      tableData.value = res.data?.list || res.list || []
      pagination.total = res.data?.total || res.total || 0
    }
  } catch (e) {
    console.error(e)
  } finally {
    loading.value = false
  }
}
```

在 H5 移动端应用中，通过 `api.contract.getConfigs()` 方法调用此接口。

**Section sources**
- [index.js](file://agx-admin/src/api/agx/index.js#L115-L121)
- [contract.vue](file://agx-admin/src/views/agx/contract.vue#L188-L194)

## 使用场景

该接口主要用于以下场景：

1. **管理后台初始化**：在 `contract.vue` 页面加载时，调用此接口获取所有合约配置，并在表格中展示，供管理员查看和管理。
2. **H5 移动端应用**：在用户进行合约交易前，获取可用的合约配置列表，让用户选择合适的交易对和合约时长。
3. **数据展示**：在前端界面中展示合约配置的详细信息，包括交易对、名称、时长、收益率等。

**Section sources**
- [contract.vue](file://agx-admin/src/views/agx/contract.vue#L298-L300)
- [api.js](file://h5/src/utils/api.js#L127)

## 完整响应示例

```json
{
  "code": 0,
  "msg": "ok",
  "data": {
    "list": [
      {
        "id": 1,
        "symbol": "BTCUSDT",
        "name": "BTC 30秒合约",
        "duration": 30,
        "profitRate": "85",
        "minAmount": "10",
        "maxAmount": "10000",
        "payCurrencies": "USDT",
        "status": 1,
        "createdAt": "2024-01-15 10:30:45"
      },
      {
        "id": 2,
        "symbol": "ETHUSDT",
        "name": "ETH 60秒合约",
        "duration": 60,
        "profitRate": "80",
        "minAmount": "5",
        "maxAmount": "5000",
        "payCurrencies": "USDT,CNY",
        "status": 1,
        "createdAt": "2024-01-15 10:31:20"
      },
      {
        "id": 3,
        "symbol": "BNBUSDT",
        "name": "BNB 120秒合约",
        "duration": 120,
        "profitRate": "75",
        "minAmount": "20",
        "maxAmount": "2000",
        "payCurrencies": "USDT",
        "status": 0,
        "createdAt": "2024-01-15 10:32:10"
      }
    ],
    "total": 3
  }
}
```

**Section sources**
- [admin.service.ts](file://agx-backend/src/modules/admin/admin.service.ts#L403-L418)
- [contract.vue](file://agx-admin/src/views/agx/contract.vue#L195-L197)